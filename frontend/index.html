<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathSolver - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏–π</title>

    <link rel="stylesheet" href="static/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body,
        button,
        input,
        textarea,
        select {
            font-family: 'Montserrat', 'Segoe UI', Tahoma, Geneva, sans-serif;
        }
    </style>
    <!-- <script type="text/javascript" src="static/navigation.js"></script> -->
    <!-- <script type="text/javascript" src="static/script.js"></script> -->
    <!-- <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [
                    ['$', '$'],
                    ['\\(', '\\)']
                ],
                displayMath: [
                    ['$$', '$$'],
                    ['\\[', '\\]']
                ],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-text">MathSolver</span>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="main">–ì–ª–∞–≤–Ω–∞—è</button>
                <button class="nav-tab" data-tab="solve">–†–µ—à–∏—Ç—å</button>
            </nav>
            <div class="header-controls">
                <div class="user-profile" id="userProfile">
                    <i class="fas fa-user-circle"></i>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- Home Tab Content -->
                <div class="tab-content" id="mainTab">
                    <div class="home-layout">
                        <!-- Hero Section -->
                        <section class="hero-section">
                            <div class="hero-content">
                                <h1 class="hero-title">–•–≤–∞—Ç–∏—Ç –±–æ—è—Ç—å—Å—è –æ—à–∏–±–æ–∫ ‚Äî –Ω–∞—á–Ω–∏—Ç–µ –∏—Ö –ø–æ–Ω–∏–º–∞—Ç—å</h1>
                                <p class="hero-subtitle">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä —Å –ò–ò, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –≤–∞—à–∏ –æ—à–∏–±–∫–∏ –Ω–∞—Å–∫–≤–æ–∑—å. –†–µ—à–∞–π—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é</p>
                                <button class="cta-button" id="startSolvingBtn">
                                <span>–†–µ—à–∞—Ç—å</span>
                                <i class="fas fa-arrow-right"></i>
                            </button>
                            </div>
                            <div class="hero-visual">
                                <div class="math-animation">
                                    <div class="formula">x¬≤ - 5x + 6 = 0</div>
                                    <div class="arrow">‚Üí</div>
                                    <div class="solution">(x-2)(x-3) = 0</div>
                                </div>
                            </div>
                        </section>

                        <!-- How It Works Section -->
                        <section class="how-it-works">
                            <h2>–ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢?</h2>
                            <div class="steps-grid">
                                <div class="step">
                                    <div class="step-icon">
                                        <i class="fas fa-edit"></i>
                                    </div>
                                    <h3>1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ</h3>
                                    <p>–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ –∏–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –≤–∞—à–µ —Ä—É–∫–æ–ø–∏—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ</p>
                                </div>
                                <div class="step">
                                    <div class="step-icon">
                                        <i class="fas fa-brain"></i>
                                    </div>
                                    <h3>2. –ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç</h3>
                                    <p>–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∏ –∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ –≤–∞—à–µ–º —Ä–µ—à–µ–Ω–∏–∏</p>
                                </div>
                                <div class="step">
                                    <div class="step-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <h3>3. –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏</h3>
                                    <p>–°–∏—Å—Ç–µ–º–∞ –¥–∞—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫</p>
                                </div>
                                <div class="step">
                                    <div class="step-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <h3>4. –£–ª—É—á—à–∞–π—Ç–µ—Å—å</h3>
                                    <p>–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å –ª—É—á—à–µ —Å –∫–∞–∂–¥—ã–º —Ä–µ—à–µ–Ω–∏–µ–º</p>
                                </div>
                            </div>
                        </section>

                        <!-- Daily Challenge & Quick Start -->
                        <section class="bottom-section">
                            <div class="daily-challenge">
                                <h3>–†–µ—à–∏—Ç–µ Daily</h3>
                                <div class="daily-task-card">
                                    <div class="task-badge">
                                        <i class="fas fa-star"></i>
                                        <span>+5 –∑–≤–µ–∑–¥</span>
                                    </div>
                                    <div class="task-content">
                                        <h4>–ó–∞–¥–∞—á–∞ –¥–Ω—è</h4>
                                        <p id="dailyTaskText">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á–∏...</p>
                                    </div>
                                    <button class="solve-daily-btn">–†–µ—à–∏—Ç—å</button>
                                </div>
                            </div>

                            <div class="quick-start">
                                <div class="quick-panel">
                                    <h4>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ</h4>
                                    <div class="quick-upload" id="quickUpload">
                                        <i class="fas fa-camera"></i>
                                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —Ä–µ—à–µ–Ω–∏—è</p>
                                    </div>
                                </div>
                                <div class="quick-panel">
                                    <h4>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è</h4>
                                    <div class="quick-result" id="quickResult">
                                        
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Solve Tab Content -->
                <div class="tab-content" id="solveTab" style="display: none;">
                    <div class="solve-container">
                        <!-- Centered Task Input Section -->
                        <section class="task-input-section-new">
                            <h3 class="task-input-title">–ß—Ç–æ —Å–µ–≥–æ–¥–Ω—è —Ä–µ—à–∏–º?</h3>
                            <div class="task-input-container">
                                <textarea class="task-input-field" id="taskInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏..." rows="1"></textarea>
                                <div class="task-input-buttons">
                                    <button class="random-task-btn" title="–°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–∞—á–∞">
                                    <i class="fas fa-dice"></i>
                                    <span>–°–ª—É—á–∞–π–Ω–∞—è</span>
                                </button>
                                    <button class="task-library-btn" id="taskLibraryBtn" title="–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞–¥–∞—á">
                                    <i class="fas fa-plus"></i>
                                </button>
                                </div>
                            </div>
                            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ (—Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ –∑–≤–µ–∑–¥—ã) -->
                            <div class="task-info-box" id="taskInfoBox" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(20, 20, 20, 0.8); border-radius: 10px; border: 1px solid rgba(255, 255, 255, 0.1);">
                                <div style="display: flex; gap: 2rem; align-items: center;">
                                    <div>
                                        <strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> <span id="taskDifficultyDisplay">-</span>
                                    </div>
                                    <div id="taskStarsDisplay" style="display: none;">
                                        <strong>–ù–∞—á–∏—Å–ª–µ–Ω–æ –∑–≤–µ–∑–¥:</strong> ‚≠ê <span id="taskStarsCount">0</span>
                                    </div>
                                    <div>
                                        <strong>–ü—Ä–æ–≥—Ä–µ—Å—Å:</strong> <span id="taskProgressDisplay">0%</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Solution Panels -->
                        <section class="solution-section-new">
                            <div class="solution-panels-new">
                                <!-- Left Panel - File Upload with Preview -->
                                <div class="solution-panel-new left-panel-new">
                                    <div class="panel-header-new">
                                        <h4>–í–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ</h4>
                                    </div>
                                    <div class="file-upload-area-new" id="fileUploadArea">
                                        <div class="upload-placeholder" id="uploadPlaceholder">
                                            <i class="fas fa-plus upload-icon"></i>
                                            <p>–î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª —Å —Ä–µ—à–µ–Ω–∏–µ–º</p>
                                            <small>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: PDF, JPG, PNG, TXT</small>
                                        </div>
                                        <div class="file-preview" id="filePreview" style="display: none;">
                                            <img id="imagePreview" style="display: none;" />
                                            <canvas id="pdfPreview" style="display: none;"></canvas>
                                            <div class="file-info" id="fileInfo"></div>
                                        </div>
                                        <input type="file" id="fileInput" accept=".pdf,.jpg,.jpeg,.png,.txt" hidden>
                                    </div>

                                    <!-- Progress Bar for Checking -->
                                    <div class="check-progress" id="checkProgress" style="display: none;">
                                        <div class="progress-label">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è...</div>
                                        <div class="progress-bar-new">
                                            <div class="progress-fill-new" id="progressFill"></div>
                                        </div>
                                        <div class="progress-percentage" id="progressPercentage">0%</div>
                                        
                                        <!-- Google Dinosaur Game -->
                                        <div class="dino-game-container" id="dinoGameContainer">
                                            <div class="game" id="dinoGame">
                                                <div class="dino" id="dino"></div>
                                                <div class="cactus" id="cactus"></div>
                                                <div class="dino-score" id="dinoScore">–°—á–µ—Ç: 0</div>
                                            </div>
                                            <div class="dino-instructions">–ù–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –∏–ª–∏ ‚Üë –¥–ª—è –ø—Ä—ã–∂–∫–∞</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Right Panel - Results -->
                                <div class="solution-panel-new right-panel-new">
                                    <div class="panel-header-new">
                                        <h4>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è</h4>
                                    </div>
                                    <div class="results-area-new" id="resultsArea">
                                        
                                    </div>
                                </div>
                            </div>

                            <!-- Check Button -->
                            <div class="check-button-container">
                                <button class="check-errors-btn-new" id="checkErrorsBtn" disabled>
                                <span class="btn-text">–ù–∞–π—Ç–∏ –æ—à–∏–±–∫–∏</span>
                                <div class="loading-spinner" id="loadingSpinner">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                            </button>
                            </div>

                            <!-- Reveal Hint Cards -->
                            <div class="reveal-hints-section" id="revealHintsSection">
                                <div class="reveal-hint-card locked" data-cost="5">
                                    <div class="locked-layer">
                                        <i class="fas fa-star"></i>
                                        <span>5 –∑–≤–µ–∑–¥</span>
                                    </div>
                                    <div class="hint-latex-content">
                                        <p>–î–ª—è —É—Ä–∞–≤–Ω–µ–Ω–∏—è $ax^2 + bx + c = 0$ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É–ª—É –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–∞:</p>
                                        <p>$$\Delta = b^2 - 4ac$$</p>
                                        <p>–ï—Å–ª–∏ $\Delta \ge 0$, —Ç–æ –∫–æ—Ä–Ω–∏ —Ä–∞–≤–Ω—ã $$x_{1,2} = \frac{-b \pm \sqrt{\Delta}}{2a}$$</p>
                                    </div>
                                </div>

                                <div class="reveal-hint-card locked" data-cost="8">
                                    <div class="locked-layer">
                                        <i class="fas fa-star"></i>
                                        <span>8 –∑–≤–µ–∑–¥</span>
                                    </div>
                                    <div class="hint-latex-content">
                                        <p>–ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Å—Ç–µ–ø–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫:</p>
                                        <p>$$\frac{d}{dx}\left(x^n\right) = n\cdot x^{n-1}$$</p>
                                        <p>–î–ª—è —Å–ª–æ–∂–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ —Ü–µ–ø–æ—á–∫–∏: $$\frac{d}{dx}f(g(x)) = f'(g(x))\cdot g'(x)$$</p>
                                    </div>
                                </div>

                                <div class="reveal-hint-card locked" data-cost="10">
                                    <div class="locked-layer">
                                        <i class="fas fa-star"></i>
                                        <span>10 –∑–≤–µ–∑–¥</span>
                                    </div>
                                    <div class="hint-latex-content">
                                        <p>–û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –∏–Ω—Ç–µ–≥—Ä–∞–ª –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—É—é $F(x)$:</p>
                                        <p>$$\int_a^b f(x)\,dx = F(b) - F(a)$$</p>
                                        <p>–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–ª–æ–∂–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–π—Å—Ç–≤–æ $$\int_a^b (f(x) + g(x))\,dx = \int_a^b f(x)\,dx + \int_a^b g(x)\,dx$$</p>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>

            </div>
        </main>

        <!-- Add Task Modal -->
        <div class="modal" id="addTaskModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h3>
                    <button class="close-modal" id="closeModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="task-input-field">
                        <label>–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:</label>
                        <textarea id="newTaskInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —É—Å–ª–æ–≤–∏–µ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏..."></textarea>
                    </div>
                    <div class="daily-task-section">
                        <h4>Daily</h4>
                        <div class="daily-task highlighted">
                            <div class="task-points">
                                <i class="fas fa-star"></i> +5 –∑–≤–µ–∑–¥
                            </div>
                            <div class="task-description">–†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–Ω—è</div>
                        </div>
                    </div>
                    <div class="tasks-lists">
                        <div class="solved-tasks">
                            <h5>–†–µ—à–µ–Ω–Ω—ã–µ:</h5>
                            <div class="task-item solved">
                                <i class="fas fa-check-circle"></i>
                                <span>–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è</span>
                            </div>
                            <div class="task-item solved">
                                <i class="fas fa-check-circle"></i>
                                <span>–°–∏—Å—Ç–µ–º—ã —É—Ä–∞–≤–Ω–µ–Ω–∏–π</span>
                            </div>
                        </div>
                        <div class="unsolved-tasks">
                            <h5>–ù–µ—Ä–µ—à–µ–Ω–Ω—ã–µ:</h5>
                            <div class="task-item unsolved">
                                <i class="fas fa-times-circle"></i>
                                <span>–ò–Ω—Ç–µ–≥—Ä–∞–ª—ã</span>
                            </div>
                            <div class="task-item unsolved">
                                <i class="fas fa-times-circle"></i>
                                <span>–ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" id="cancelBtn">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" id="saveTaskBtn">–†–µ—à–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Task Library Modal -->
    <div class="task-library-overlay" id="taskLibraryOverlay" style="display: none;">
        <div class="task-library-modal">
            <div class="task-library-header">
                <h3>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∑–∞–¥–∞—á</h3>
                <button class="close-library-btn" id="closeLibraryBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="task-library-filters">
                <select class="task-filter-select" id="categoryFilter">
                    <option value="">–í—Å–µ —Ç–µ–º—ã</option>
                </select>
                <select class="task-filter-select" id="difficultyFilter">
                    <option value="">–í—Å–µ —É—Ä–æ–≤–Ω–∏</option>
                </select>
            </div>

            <div class="task-library-content">
                <!-- Daily Task Section -->
                <div class="library-section">
                    <h4 class="library-section-title">Daily –∑–∞–¥–∞—á–∞</h4>
                    <div class="daily-task-item" data-task-type="daily" style="padding: 1.5rem; min-height: 120px;">
                        <div class="task-badge-small">
                            <i class="fas fa-star"></i>
                            <span>+5 –∑–≤–µ–∑–¥</span>
                        </div>
                        <div class="task-text" style="font-size: 1rem; line-height: 1.6; margin-top: 1rem; white-space: normal; word-wrap: break-word;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á–∏...</div>
                    </div>
                </div>

                <!-- Solved Tasks Section -->
                <div class="library-section">
                    <h4 class="library-section-title">–†–µ—à–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏</h4>
                    <div class="solved-tasks-grid" id="solvedTasksGrid">
                        <!-- Solved tasks will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Unsolved Tasks Section -->
                <div class="library-section">
                    <h4 class="library-section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞—á–∏</h4>
                    <div class="unsolved-tasks-grid" id="unsolvedTasksGrid">
                        <!-- Unsolved tasks will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- AI Chat Bot -->
    <div class="ai-chat-toggle" id="aiChatToggle">
        <div class="robot-icon">
            <i class="fas fa-robot"></i>
        </div>
        <div class="chat-notification" id="chatNotification" style="display: none;">
            <span>1</span>
        </div>
    </div>

    <div class="ai-chat-overlay" id="aiChatOverlay" style="display: none;">
        <div class="ai-chat-container">
            <div class="ai-chat-header">
                <div class="ai-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="ai-info">
                    <h4>MathBot AI</h4>
                    <span class="ai-status">–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –º–∞—Ç–µ–º–∞—Ç–∏–∫–æ–π</span>
                </div>
                <button class="close-chat-btn" id="closeChatBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>–ü—Ä–∏–≤–µ—Ç! –Ø MathBot AI ü§ñ</p>
                        <p>–ú–æ–≥—É –ø–æ–º–æ—á—å —Å —Ä–µ—à–µ–Ω–∏–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, –æ–±—ä—è—Å–Ω–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã –∏–ª–∏ –¥–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏. –ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å!</p>
                        <div class="message-time">–°–µ–π—á–∞—Å</div>
                    </div>
                </div>
            </div>

            <div class="ai-chat-input-area">
                <div class="quick-questions">
                    <button class="quick-question-btn" data-question="–û–±—ä—è—Å–Ω–∏ –∫–∞–∫ —Ä–µ—à–∞—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è">
                        –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
                    </button>
                    <button class="quick-question-btn" data-question="–ü–æ–º–æ–≥–∏ —Å –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–º–∏">
                        –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ
                    </button>
                    <button class="quick-question-btn" data-question="–ö–∞–∫ –Ω–∞–π—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª?">
                        –ò–Ω—Ç–µ–≥—Ä–∞–ª—ã
                    </button>
                </div>

                <div class="chat-input-container" style="display: flex; align-items: flex-end; gap: 0.5rem;">
                    <textarea class="ai-chat-input" id="aiChatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..." rows="1"></textarea>
                    <button class="send-message-btn" id="sendMessageBtn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Profile Modal -->
    <div class="profile-overlay" id="profileOverlay" style="display: none;">
        <div class="profile-container">
            <div class="profile-header">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-info">
                    <h3>–ú–∞—Ç–µ–º–∞—Ç–∏–∫</h3>
                    <span class="profile-level">–£—Ä–æ–≤–µ–Ω—å 5 ‚Ä¢ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π</span>
                </div>
                <button class="close-profile-btn" id="closeProfileBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="profile-content">
                <!-- Statistics Cards - —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ –∏ –∑–≤–µ–∑–¥–æ—á–∫–∏ -->
                <div class="stats-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="profileSolvedTasks">0</div>
                            <div class="stat-label">–†–µ—à–µ–Ω–æ –∑–∞–¥–∞—á</div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="profileStars">0</div>
                            <div class="stat-label">–ó–≤–µ–∑–¥–æ—á–µ–∫</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="static/api.js"></script>
    <script src="static/js/user-data.js"></script>
    <script src="static/js/app.js"></script>
    <script src="static/js/chatbot.js"></script>
    <script src="static/js/profile.js"></script>
    <script src="static/navigation.js"></script>
    <script src="static/js/task-manager.js"></script>

    <script>
        // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, checking navigation...');
            taskManager.initialize();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º daily –∑–∞–¥–∞—á—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            loadDailyTaskOnMainPage();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const navTabs = document.querySelectorAll('.nav-tab');
            const tabContents = document.querySelectorAll('.tab-content');

            console.log('Found nav tabs:', navTabs.length);
            console.log('Found tab contents:', tabContents.length);

            // –ï—Å–ª–∏ navigation.js –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–¥–µ—Å—å
            if (navTabs.length > 0) {
                navTabs.forEach((tab, index) => {
                    console.log(`Tab ${index}:`, tab.dataset.tab);
                    tab.addEventListener('click', function() {
                        console.log('Tab clicked:', this.dataset.tab);
                        switchTabSimple(this.dataset.tab);
                    });
                });
            }

            function switchTabSimple(tabName) {
                console.log('Switching to tab:', tabName);

                // –£–±–∏—Ä–∞–µ–º active —É –≤—Å–µ—Ö —Ç–∞–±–æ–≤
                navTabs.forEach(tab => tab.classList.remove('active'));

                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–Ω—Ç—ã
                tabContents.forEach(content => {
                    content.style.display = 'none';
                });

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
                const targetContent = document.getElementById(tabName + 'Tab');
                if (targetContent) {
                    targetContent.style.display = 'block';
                    console.log('Showed content for:', tabName);
                } else {
                    console.error('Content not found for:', tabName + 'Tab');
                }

                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
                const activeTab = document.querySelector(`[data-tab="${tabName}"]`);
                if (activeTab) {
                    activeTab.classList.add('active');
                    console.log('Activated tab:', tabName);
                }
            }

            // –ö–Ω–æ–ø–∫–∞ "–†–µ—à–∞—Ç—å"
            const startBtn = document.getElementById('startSolvingBtn');
            if (startBtn) {
                startBtn.addEventListener('click', () => {
                    console.log('Start solving clicked');
                    switchTabSimple('solve');
                });
            }

            // –ö–Ω–æ–ø–∫–∞ "–†–µ—à–∏—Ç—å Daily"
            const dailyBtn = document.querySelector('.solve-daily-btn');
            if (dailyBtn) {
                dailyBtn.addEventListener('click', () => {
                    console.log('Daily task clicked');
                    switchTabSimple('solve');
                });
            }

            // –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userProfile = document.getElementById('userProfile');
            const profileOverlay = document.getElementById('profileOverlay');
            const closeProfileBtn = document.getElementById('closeProfileBtn');

            if (userProfile && profileOverlay) {
                userProfile.addEventListener('click', () => {
                    console.log('Profile clicked');
                    profileOverlay.style.display = 'flex';
                });
            }

            if (closeProfileBtn && profileOverlay) {
                closeProfileBtn.addEventListener('click', () => {
                    console.log('Close profile clicked');
                    profileOverlay.style.display = 'none';
                });
            }

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ –∫–ª–∏–∫—É –Ω–∞ overlay
            if (profileOverlay) {
                profileOverlay.addEventListener('click', (e) => {
                    if (e.target === profileOverlay) {
                        profileOverlay.style.display = 'none';
                    }
                });
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç-–±–æ—Ç–∞
            if (window.chatbotManager && typeof window.chatbotManager.initialize === 'function') {
                console.log('Initializing chatbot...');
                window.chatbotManager.initialize();
            } else {
                console.warn('chatbotManager not available');
            }


            // –¢–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
            window.testSolveTask = function() {
                console.log('Test solve task clicked');
                alert('–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞! +20 XP');
            };

            window.testDailyTask = function() {
                console.log('Test daily task clicked');
                alert('Daily –∑–∞–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∞! +50 XP');
            };
        });

        // –í—Å–µ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º–Ω—É—é —Ç–µ–º—É
        document.body.classList.add('dark-theme');
        document.body.classList.remove('light-theme');
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ daily –∑–∞–¥–∞—á–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        async function loadDailyTaskOnMainPage() {
            try {
                // Daily –∑–∞–¥–∞—á–∞ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –Ω–∞ –¥–µ–Ω—å
                const task = await getDailyTask([]);
                const dailyTaskText = document.getElementById('dailyTaskText');
                if (dailyTaskText && task) {
                    // –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–∫ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∑–∞–¥–∞—á: –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ,
                    // –∏–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ (description/statement)
                    if (task.completed === true) {
                        dailyTaskText.textContent = '–í—ã —É–∂–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –∑–∞–¥–∞—á—É';
                    } else {
                        const taskDescription = task.description || task.statement || '–ó–∞–¥–∞—á–∞ –¥–Ω—è';
                        dailyTaskText.textContent = taskDescription;
                    }
                    // –†–µ–Ω–¥–µ—Ä–∏–º LaTeX
                    if (window.MathJax && window.MathJax.typesetPromise) {
                        await window.MathJax.typesetPromise([dailyTaskText]);
                    }
                }
            } catch (err) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ daily –∑–∞–¥–∞—á–∏:', err);
                const dailyTaskText = document.getElementById('dailyTaskText');
                if (dailyTaskText) {
                    dailyTaskText.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–¥–∞—á—É';
                }
            }
        }
    </script>
</body>

</html>